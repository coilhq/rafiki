# Rafiki Admin

## Development

This project assumes that you have a local Rafiki backend instance up and running. Typically, both `backend` and this project would be used within the local Rafiki playground. See the [local environment setup](../../localenv) for more information on how to set it up.

To start the project in development mode, we first need to generate the GraphQL types for our queries and mutations.

To generate the GraphQL types file run:

```sh
pnpm --filter backend generate
```

To start the application run:

```sh
pnpm --filter frontend dev
```

Now you can access the application on [http://localhost:3005](http://localhost:3005).

> NOTE: When running Rafiki Admin in the development environment, it will connect to Cloud Nine Wallet Admin GraphQL - [http://localhost:3001/graphql](http://localhost:3001/graphql).

To add a new typed apollo request, you will need to add an untyped request and regenerate the graphql types. This will generate new types tailored to the specific request being made. The generated type will reflect the request's query or mutation name, variables used, and requested fields.

## Structure

```
ðŸ“¦frontend
 â”£ ðŸ“‚app
 â”ƒ â”£ ðŸ“‚components
 â”ƒ â”ƒ â”£ ðŸ“‚ui
 â”ƒ â”£ ðŸ“‚generated
 â”ƒ â”£ ðŸ“‚lib
 â”ƒ â”ƒ â”£ ðŸ“‚api
 â”ƒ â”£ ðŸ“‚routes
 â”ƒ â”£ ðŸ“‚shared
 â”ƒ â”£ ðŸ“‚styles
 â”£ ðŸ“‚public
```

- `app`: source of the application
  - `components`: domain-related components
    - `ui`: reusable code blocks and components that comprise the UI/design system
  - `generated`: types generated by GraphQL Code Gen
  - `lib`: business logic
    - `api`: GraphQL queries and mutations
  - `routes`: outer layer of the application
  - `shared`: utilility functions or types
  - `styles`: CSS files
- `public`: static files and assets that are served to the browser

## Auth

TODO: add docs here
Current set up
How to make this setup suitable for prod
How to get access tokens without Admin UI - maybe this should go in backend docs
Links to Hydra and Kratos docs and GitHub
Ory Kratos and your UI must be on the hosted on same top level domain! You can not host Ory Kratos and your UI on separate top level domains.
Explain version requirements, had to downgrade to be compatible with Kratos login_challenge handling
Add explanation for all the new environment variables that are needed
Run docker exec -it rafiki-cloud-nine-admin-1 npm run invite-user -- example@mail.com and it will output recovery link on screen
